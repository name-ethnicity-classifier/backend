openapi: 3.0.3
info:
  title: name-to-ethnicity API
  description: |-
    This is the official REST API documentation for www.name-to-ethnicity.com. Using our public API you can classify names into their most likely ethnicity and retireve a list of all your models.
    
  termsOfService: https://www.name-to-ethnicity.com/terms-of-service
  contact:
    email: theodorpeifer@gmail.com
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  version: 1.0.0
  
tags:
  - name: Endpoints

paths:
  /default-models:
    get:
      tags:
        - Endpoints
      summary: Retrieve all of our default models
      description: This endpoint will return a list containing all of our already trained default models along with the following information
      
        - ethnicities it can classifiy between
        
        - overall accuracy
        
        - accuracy per ethnicity
    
      operationId: getDefaultModels
      responses:
        '200':
          description: Successful
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Model'
        '500':
          description: Server side error
  
  /models:
    get:
      tags:
        - Endpoints
      summary: Retrieve all of your custom models
      description: This endpoint will return a list containing all of your custom trained and default models along with the following information
      
        - ethnicities it can classifiy between
        
        - overall accuracy
        
        - accuracy per ethnicity
      operationId: getCustomModels
      responses:
        '200':
          description: Successful
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Models'
        '500':
          description: Server side error
      security:
        - api_key: []
        
  /classify:
    post:
      tags:
        - Endpoints
      summary: Classifiy names into their ethnicities
      description: |
        Using this endpoint, you can classify names into their most likely ethnicity.  
        - If `getDistribution` is **False**, the response provides the most likely ethnicity and its confidence.  
        - If `getDistribution` is **True**, the response provides the entire confidence distribution.
      operationId: classifyNames
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Classification'

      responses:
        '200':
          description: Successful
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/ClassifiedNames'
                  - $ref: '#/components/schemas/ClassifiedNamesDistribution'
              examples:
                mostLikelyConfidence:
                  summary: getDistribution = false
                  description: Response when `getDistribution` is **False** returns the ethnicity with the highest confidence.
                  value:
                    cixin liu:
                      - "chinese"
                      - 0.97
                    john doe:
                      - "american"
                      - 0.85
                    theo baumgartner:
                      - "german"
                      - 0.92
                confidenceDistribution:
                  summary: getDistribution = true
                  description: Response when `getDistribution` is **True** returns the entire confidence distribution (sums up to 1.0).
                  value:
                    cixin liu:
                      chinese: 0.97
                      american: 0.02
                      german: 0.01
                    john doe:
                      chinese: 0.85
                      american: 0.10
                      german: 0.05
                    theo baumgartner:
                      chinese: 0.04
                      american: 0.04
                      german: 0.92
        '300':
          description: Unexpected classification error
        '411':
          description: Too many names
        '422':
          description: Model data validation failed
        '500':
          description: Server side error
          
components:
  schemas:
    Classification:
      type: object
      properties:
        modelName:
          type: string
          example: "american_chinese_german"
        names:
          type: array
          items:
            type: string
          example: ["cixin liu", "john doe", "theo baumgartner"]
        getDistribution:
          type: boolean
          example: false

    Model:
      type: object
      properties:
        name:
          type: string
          example: chinese_and_else
        description:
          type: string
          nullable: true
          example: "Example model description."
        accuracy:
          type: number
          example: 0.98
        nationalities:
          type: array
          items:
            type: string
          example: ["chinese", "else"]
        scores:
          type: array
          items:
            type: number
          example:
            [0.99, 0.97]
        creationTime:
          type: string
          example: "01-01-2021T07:21:00"

    Models:
      type: object
      properties:
        defaultModels:
          type: array
          items:
            $ref: '#/components/schemas/Model'
        customModels:
          type: array
          items:
            $ref: '#/components/schemas/Model'

    ClassifiedNames:
      type: object
      additionalProperties:
        type: array
        items:
          oneOf:
            - type: string
              description: "Classified ethnicity."
            - type: number
              description: "Confidence of prediction."
      example:
        cixin liu:
          - "chinese"
          - 0.99
        john doe:
          - "american"
          - 0.85

    ClassifiedNamesDistribution:
      type: object
      additionalProperties:
        type: object
        additionalProperties:
          type: number
          example: 0.95
      example:
        cixin liu:
          chinese: 0.97
          american: 0.02
          german: 0.01
        john doe:
          chinese: 0.85
          american: 0.10
          german: 0.05
        theo baumgartner:
          chinese: 0.01
          american: 0.04
          german: 0.95
            
  securitySchemes:
    api_key:
      type: apiKey
      name: api_key
      in: header
      description: "Prefix 'Beaerer' followed by a space and then a JWT token"